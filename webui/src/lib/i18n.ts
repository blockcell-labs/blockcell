import { create } from 'zustand';

export type Locale = 'en' | 'zh';

interface I18nState {
  locale: Locale;
  setLocale: (locale: Locale) => void;
}

export const useI18nStore = create<I18nState>((set) => ({
  locale: (localStorage.getItem('blockcell_locale') as Locale) || 'en',
  setLocale: (locale) => {
    localStorage.setItem('blockcell_locale', locale);
    set({ locale });
  },
}));

const translations: Record<Locale, Record<string, string>> = {
  en: {
    // Sidebar
    'nav.chat': 'Chat',
    'nav.tasks': 'Tasks',
    'nav.dashboard': 'Dashboard',
    'nav.memory': 'Memory',
    'nav.ghost': 'Ghost Agent',
    'nav.cron': 'Cron Jobs',
    'nav.alerts': 'Alerts',
    'nav.streams': 'Streams',
    'nav.files': 'Files',
    'nav.settings': 'Settings',
    'sidebar.sessions': 'Sessions',
    'sidebar.newChat': 'New chat',
    'sidebar.connected': 'Connected',
    'sidebar.disconnected': 'Disconnected',
    'sidebar.logout': 'Logout',
    'sidebar.logoutConfirm': 'Are you sure you want to sign out?',
    'sidebar.lightMode': 'Light mode',
    'sidebar.darkMode': 'Dark mode',
    'sidebar.deleteSession': 'Delete Session',
    'sidebar.deleteSessionConfirm': 'Are you sure you want to delete this session?',
    'sidebar.scrollToLoadMore': 'Scroll to load more...',
    'common.cancel': 'Cancel',
    'common.delete': 'Delete',
    'common.save': 'Save',
    'common.loading': 'Loading...',
    'common.search': 'Search',
    'common.refresh': 'Refresh',
    'common.create': 'Create',
    'common.run': 'Run',
    'common.upload': 'Upload',
    'common.download': 'Download',
    'common.close': 'Close',
    'common.confirm': 'Confirm',
    'common.success': 'Success',
    'common.error': 'Error',
    'common.noData': 'No data',

    // Login
    'login.title': 'Blockcell',
    'login.subtitle': 'Enter password to continue',
    'login.password': 'Password',
    'login.signIn': 'Sign In',
    'login.signingIn': 'Signing in...',
    'login.hint': 'Password is shown in the gateway console at startup',
    'login.invalidPassword': 'Invalid password',
    'login.cannotConnect': 'Cannot connect to gateway',

    // Chat
    'chat.emptyTitle': 'BLOCKCELL',
    'chat.emptyHint': '> Send a message to initialize protocol',
    'chat.thinking': 'Thinking...',
    'chat.inputPlaceholder': 'Input command or query...',

    // Connection overlay
    'conn.authFailed': 'Authentication Failed',
    'conn.authFailedDesc': 'The gateway has been restarted and the session token is no longer valid. Please sign in again with the new password shown in the gateway console.',
    'conn.relogin': 'Sign In Again',
    'conn.serverDown': 'Server Unavailable',
    'conn.serverDownDesc': 'Unable to reach the gateway server. Please check that the gateway process is running.',
    'conn.networkError': 'Connection Lost',
    'conn.networkErrorDesc': 'The connection to the gateway was interrupted. Please check your network.',
    'conn.reconnecting': 'Reconnecting...',
    'conn.reconnectAttempt': 'Attempt {n}',
    'conn.reconnectWait': 'Retrying in {sec}s...',
    'conn.retry': 'Retry Now',
    'conn.connecting': 'Connecting...',
    'conn.connectingDesc': 'Establishing connection to the gateway...',
    'conn.checkNetwork': 'Check your network connection and ensure the gateway is running.',
    'conn.checkGateway': 'Start the gateway with: blockcell gateway',
    'conn.dismiss': 'Dismiss',
    'conn.copyCmd': 'Copy Command',
    'conn.copied': 'Copied!',

    // Settings
    'settings.title': 'Settings',
    'settings.general': 'General',
    'settings.language': 'Language',
    'settings.languageDesc': 'Select display language for the interface',
    'settings.theme': 'Theme',
    'settings.themeDesc': 'Choose the appearance of the interface',
    'settings.themeDark': 'Dark',
    'settings.themeLight': 'Light',
    'settings.themeSystem': 'System',
    'settings.configuration': 'Configuration',
    'settings.configDesc': 'Edit the raw gateway configuration JSON',
    'settings.editConfig': 'Edit Configuration',
    'settings.testProvider': 'Test Provider',
    'settings.configSaved': 'Configuration saved successfully',
    'settings.about': 'About',
    'settings.version': 'Version',
    'settings.website': 'Official Website',
    'settings.visitWebsite': 'Visit',
    'settings.security': 'Security',
    'settings.logoutDesc': 'Sign out and clear your session',
    'settings.logoutBtn': 'Sign Out',

    // Cron
    'cron.title': 'Cron Jobs',
    'cron.create': 'Create Job',
    'cron.empty': 'No cron jobs configured',
    'cron.emptyHint': 'Create a scheduled job to automate tasks',
    'cron.deleteCron': 'Delete Cron Job',
    'cron.deleteConfirm': 'Are you sure you want to delete "{name}"? This action cannot be undone.',
    'cron.runCron': 'Run Cron Job',
    'cron.runConfirm': 'Run "{name}" now?',
    'cron.jobDeleted': 'Job "{name}" deleted',
    'cron.jobTriggered': 'Job "{name}" triggered successfully',
    'cron.deleteFailed': 'Failed to delete job',
    'cron.runFailed': 'Failed to run job',
    'cron.name': 'Name',
    'cron.schedule': 'Schedule',
    'cron.command': 'Command',

    // Tasks
    'tasks.title': 'Tasks',
    'tasks.queued': 'Queued',
    'tasks.running': 'Running',
    'tasks.completed': 'Completed',
    'tasks.failed': 'Failed',
    'tasks.empty': 'No tasks yet',
    'tasks.emptyHint': 'Tasks will appear here when the agent processes messages',

    // Dashboard
    'dashboard.title': 'Dashboard',
    'dashboard.status': 'Status',
    'dashboard.model': 'Model',
    'dashboard.uptime': 'Uptime',
    'dashboard.version': 'Version',
    'dashboard.memoryItems': 'Memory Items',
    'dashboard.evolutionRecords': 'Evolution Records',
    'dashboard.activeTasks': 'Active Tasks',
    'dashboard.tools': 'Tools',
    'dashboard.skills': 'Skills',
    'dashboard.recentEvolution': 'Recent Evolution',
    'dashboard.noTools': 'No tools registered',
    'dashboard.noSkills': 'No skills found',

    // Evolution
    'nav.evolution': 'Evolution',
    'evolution.title': 'Self-Evolution',
    'evolution.triggerNew': 'New Skill',
    'evolution.totalRecords': 'Total',
    'evolution.evolving': 'Evolving',
    'evolution.completed': 'Completed',
    'evolution.failed': 'Failed',
    'evolution.skills': 'Skills',
    'evolution.tools': 'Tools',
    'evolution.skillEvolution': 'Skill Evolution',
    'evolution.capEvolution': 'Tool Evolution',
    'evolution.testAndEvolve': 'Test & Evolve',
    'evolution.filter_all': 'All',
    'evolution.filter_active': 'Active',
    'evolution.filter_completed': 'Done',
    'evolution.filter_failed': 'Failed',
    'evolution.noSkillRecords': 'No skill evolution records',
    'evolution.noCapRecords': 'No tool evolution records',
    'evolution.triggerEvolution': 'Trigger Manual Evolution',
    'evolution.skillName': 'Skill Name',
    'evolution.selectSkill': 'Select a skill...',
    'evolution.description': 'Description',
    'evolution.descPlaceholder': 'Describe what to improve...',
    'evolution.trigger': 'Trigger',
    'evolution.newSkillTitle': 'Create New Skill',
    'evolution.newSkillDesc': 'Describe the skill you want to create. The system will first search for similar existing skills.',
    'evolution.newSkillPlaceholder': 'Describe the skill functionality, e.g. "Monitor BTC price and alert when it drops below 60000"...',
    'evolution.searchingSkills': 'Searching for similar skills...',
    'evolution.similarSkillsFound': 'Similar Skills Found',
    'evolution.noSimilarSkills': 'No similar skills found. Ready to create a new one.',
    'evolution.similarSkillHint': 'A similar skill already exists. You can test it first, or proceed to create a new one.',
    'evolution.proceedCreate': 'Create New Skill Anyway',
    'evolution.useExisting': 'Use This Skill',
    'evolution.designingSkill': 'Designing new skill...',
    'evolution.skillCreated': 'Skill creation triggered',
    'evolution.newSkillName': 'Skill Name',
    'evolution.newSkillNamePlaceholder': 'e.g. btc_price_alert',
    'evolution.createSkill': 'Create Skill',
    'evolution.testAndEvolveTitle': 'Test & Evolve Skill',
    'evolution.testAndEvolveDesc': 'Test a skill and trigger evolution if the result is unsatisfactory.',
    'evolution.testResultSatisfied': 'Result Satisfactory',
    'evolution.testResultUnsatisfied': 'Needs Improvement',
    'evolution.evolveFromTest': 'Trigger Evolution',
    'evolution.evolveDesc': 'Describe what needs to be improved based on the test result:',
    'evolution.evolveDescPlaceholder': 'e.g. "The output format should include more details" or "Should handle edge case when..."',
    'evolution.evolveTriggered': 'Evolution triggered based on test feedback',
    'evolution.matchScore': 'Match',
    'evolution.matchedIn': 'Matched in',
    'evolution.attempt': 'Attempt #{n}',
    'evolution.triggerInfo': 'Trigger Info',
    'evolution.id': 'ID',
    'evolution.version': 'Version',
    'evolution.created': 'Created',
    'evolution.updated': 'Updated',
    'evolution.errorStack': 'Error Stack',
    'evolution.patch': 'Generated Patch',
    'evolution.showCode': 'Show code',
    'evolution.hideCode': 'Hide code',
    'evolution.audit': 'Audit',
    'evolution.auditPassed': 'Audit Passed',
    'evolution.auditFailed': 'Audit Failed',
    'evolution.shadowTest': 'Shadow Test',
    'evolution.testPassed': 'Test Passed',
    'evolution.testFailed': 'Test Failed',
    'evolution.rollout': 'Rollout',
    'evolution.stage': 'Stage',
    'evolution.feedbackHistory': 'Feedback History',
    'evolution.deleteRecord': 'Delete Record',
    'evolution.deleteConfirm': 'Are you sure you want to delete this evolution record?',
    'evolution.detail': 'Details',
    'evolution.provider': 'Provider',
    'evolution.sourceCode': 'Source Code',
    'evolution.compileOutput': 'Compile Output',
    'evolution.validation': 'Validation',
    'evolution.validationPassed': 'Validation Passed',
    'evolution.validationFailed': 'Validation Failed',
    'evolution.testSkillTitle': 'Test & Evolve Skill',
    'evolution.testSkillDesc': 'Select a skill, test it, and trigger evolution if the result needs improvement.',
    'evolution.testInput': 'Test Input',
    'evolution.testInputPlaceholder': 'Enter test conditions or input data...',
    'evolution.runTest': 'Run Test',
    'evolution.loadingSuggestion': 'Generating test input suggestion...',
    'evolution.executingTest': 'Executing skill test...',
    'evolution.aiSuggested': 'AI suggested · editable',
    'evolution.overview': 'Overview',
    'evolution.architecture': 'System Architecture',
    'evolution.layerAgent': 'Agent',
    'evolution.layerSkill': 'Skill',
    'evolution.layerTool': 'Tool',
    'evolution.layerCapability': 'Evolved Tool',
    'evolution.registered': 'registered',
    'evolution.builtinTools': 'built-in tools',
    'evolution.dynamicTools': 'dynamic tools',
    'evolution.skillDesc': 'Orchestration strategy evolution — improves how tasks are composed and executed',
    'evolution.capDesc': 'Atomic tool evolution — generates new system/API/hardware interaction abilities',
    'evolution.skillPipeline': 'Pipeline: Trigger → Generate → Audit → Test → Rollout → Complete',
    'evolution.skillProduct': 'Product: .md (prompt) + .rhai (script)',
    'evolution.capPipeline': 'Pipeline: Request → Generate → Compile → Validate → Active',
    'evolution.capProduct': 'Product: .sh / .py / .rs (executable)',
    'evolution.recentActivity': 'Recent Activity',
    'evolution.decisionBoundary': 'Evolution Decision Boundary',
    'evolution.decisionSkill': 'Task execution strategy needs improvement (e.g. optimize analysis flow, improve report format)',
    'evolution.decisionCap': 'New tool needed (e.g. hardware access, API integration, data processing)',
    'evolution.decisionAuto': 'Skill fails due to missing tool → auto-triggers tool evolution first',
    'evolution.versionHistory': 'Version History',
    'evolution.showVersions': 'Show versions',
    'evolution.hideVersions': 'Hide versions',
    'evolution.noVersions': 'No version snapshots yet',
    'evolution.schemas': 'Input / Output Schema',
    'evolution.artifactPath': 'Artifact',

    // Memory
    'memory.title': 'Memory',
    'memory.searchPlaceholder': 'Search memories...',
    'memory.empty': 'No memories found',
    'memory.addMemory': 'Add Memory',
    'memory.deleteTitle': 'Delete Memory',
    'memory.deleteConfirm': 'Are you sure you want to delete this memory?',

    // Alerts
    'alerts.title': 'Alerts',
    'alerts.empty': 'No alert rules configured',
    'alerts.createRule': 'Create Rule',
    'alerts.emptyHint': 'Create a rule to monitor prices, metrics, and more',
    'alerts.noHistory': 'No alert triggers yet',

    // Streams
    'streams.title': 'Streams',
    'streams.empty': 'No active streams',

    // Ghost
    'ghost.title': 'Ghost Agent',
    'ghost.settings': 'Settings',
    'ghost.activityLog': 'Activity Log',
    'ghost.description': 'The Ghost Agent is a background maintenance service that runs on a schedule to garden memories, clean up files, and interact with the community hub.',
    'ghost.enableTitle': 'Enable Ghost Agent',
    'ghost.enableDesc': 'Run background maintenance tasks on a schedule',
    'ghost.model': 'Model',
    'ghost.modelHint': 'Select a configured model or enter a custom one. Ghost uses this model for its background routine.',
    'ghost.modelPlaceholder': 'Enter model name...',
    'ghost.schedule': 'Schedule',
    'ghost.everyHour': 'Every Hour',
    'ghost.every2Hours': 'Every 2 Hours',
    'ghost.every4Hours': 'Every 4 Hours (Default)',
    'ghost.every8Hours': 'Every 8 Hours',
    'ghost.every12Hours': 'Every 12 Hours',
    'ghost.dailyMidnight': 'Daily at Midnight',
    'ghost.dailyAt2AM': 'Daily at 2 AM',
    'ghost.dailyAt6AM': 'Daily at 6 AM',
    'ghost.custom': 'Custom',
    'ghost.customHint': 'Enter cron expression',
    'ghost.currentSchedule': 'Current schedule',
    'ghost.maxSyncsPerDay': 'Max Syncs Per Day',
    'ghost.maxSyncsHint': 'Limits how many times the Ghost Agent can run per day to control costs.',
    'ghost.autoSocial': 'Auto Social Interaction',
    'ghost.enableHubSync': 'Enable Community Hub Sync',
    'ghost.autoSocialHint': 'Ghost will send heartbeats and check trending skills on the Community Hub.',
    'ghost.saveChanges': 'Save Changes',
    'ghost.saving': 'Saving...',
    'ghost.loadFailed': 'Failed to load Ghost config.',
    'ghost.noActivityTitle': 'No Ghost Activity Yet',
    'ghost.noActivityDesc': 'Enable the Ghost Agent in Settings and it will start running background maintenance tasks. Activity logs will appear here.',
    'ghost.activityRecords': '{n} activity records',
    'ghost.messages': '{n} messages',
    'ghost.routinePrompt': 'Routine Prompt',

    // Files
    'files.title': 'Files',
    'files.folders': 'folders',
    'files.fileCount': 'files',
    'files.workspace': 'workspace',
    'files.chooseFile': 'Choose File',
    'files.createTextFile': 'or create a text file:',
    'files.filenamePlaceholder': 'filename.txt',
    'files.contentPlaceholder': 'File content...',
    'files.emptyDir': 'Empty directory',
    'files.media': 'Media',
    'files.binaryFile': 'Binary file ({mimeType})',
    'files.downloadToView': 'Download to view',
  },
  zh: {
    // Sidebar
    'nav.chat': '对话',
    'nav.tasks': '任务',
    'nav.dashboard': '仪表盘',
    'nav.memory': '记忆',
    'nav.ghost': '幽灵智能体',
    'nav.cron': '定时任务',
    'nav.alerts': '告警',
    'nav.streams': '数据流',
    'nav.files': '文件',
    'nav.settings': '设置',
    'sidebar.sessions': '会话',
    'sidebar.newChat': '新建对话',
    'sidebar.connected': '已连接',
    'sidebar.disconnected': '未连接',
    'sidebar.logout': '退出登录',
    'sidebar.logoutConfirm': '确定要退出登录吗？',
    'sidebar.lightMode': '浅色模式',
    'sidebar.darkMode': '深色模式',
    'sidebar.deleteSession': '删除会话',
    'sidebar.deleteSessionConfirm': '确定要删除此会话吗？',
    'sidebar.scrollToLoadMore': '下拉加载更多...',
    'common.cancel': '取消',
    'common.delete': '删除',
    'common.save': '保存',
    'common.loading': '加载中...',
    'common.search': '搜索',
    'common.refresh': '刷新',
    'common.create': '创建',
    'common.run': '运行',
    'common.upload': '上传',
    'common.download': '下载',
    'common.close': '关闭',
    'common.confirm': '确认',
    'common.success': '成功',
    'common.error': '错误',
    'common.noData': '暂无数据',

    // Login
    'login.title': 'Blockcell',
    'login.subtitle': '输入密码以继续',
    'login.password': '密码',
    'login.signIn': '登录',
    'login.signingIn': '登录中...',
    'login.hint': '密码在 Gateway 启动时显示在控制台',
    'login.invalidPassword': '密码错误',
    'login.cannotConnect': '无法连接到 Gateway',

    // Chat
    'chat.emptyTitle': 'BLOCKCELL',
    'chat.emptyHint': '> 发送消息以启动协议',
    'chat.thinking': '思考中...',
    'chat.inputPlaceholder': '输入命令或查询...',

    // Connection overlay
    'conn.authFailed': '认证失败',
    'conn.authFailedDesc': 'Gateway 已重启，会话令牌已失效。请使用 Gateway 控制台显示的新密码重新登录。',
    'conn.relogin': '重新登录',
    'conn.serverDown': '服务不可用',
    'conn.serverDownDesc': '无法连接到 Gateway 服务器，请检查 Gateway 进程是否正在运行。',
    'conn.networkError': '连接中断',
    'conn.networkErrorDesc': '与 Gateway 的连接已中断，请检查网络连接。',
    'conn.reconnecting': '重新连接中...',
    'conn.reconnectAttempt': '第 {n} 次尝试',
    'conn.reconnectWait': '{sec} 秒后重试...',
    'conn.retry': '立即重试',
    'conn.connecting': '连接中...',
    'conn.connectingDesc': '正在建立与 Gateway 的连接...',
    'conn.checkNetwork': '请检查网络连接并确保 Gateway 正在运行。',
    'conn.checkGateway': '启动 Gateway: blockcell gateway',
    'conn.dismiss': '关闭',
    'conn.copyCmd': '复制命令',
    'conn.copied': '已复制！',

    // Settings
    'settings.title': '设置',
    'settings.general': '通用',
    'settings.language': '语言',
    'settings.languageDesc': '选择界面显示语言',
    'settings.theme': '主题',
    'settings.themeDesc': '选择界面外观',
    'settings.themeDark': '深色',
    'settings.themeLight': '浅色',
    'settings.themeSystem': '跟随系统',
    'settings.configuration': '配置',
    'settings.configDesc': '编辑 Gateway 原始配置 JSON',
    'settings.editConfig': '编辑配置',
    'settings.testProvider': '测试 Provider',
    'settings.configSaved': '配置已保存',
    'settings.about': '关于',
    'settings.version': '版本',
    'settings.website': '官方网站',
    'settings.visitWebsite': '访问',
    'settings.security': '安全',
    'settings.logoutDesc': '退出登录并清除会话',
    'settings.logoutBtn': '安全退出',

    // Cron
    'cron.title': '定时任务',
    'cron.create': '创建任务',
    'cron.empty': '暂无定时任务',
    'cron.emptyHint': '创建定时任务以自动化执行',
    'cron.deleteCron': '删除定时任务',
    'cron.deleteConfirm': '确定要删除「{name}」吗？此操作不可撤销。',
    'cron.runCron': '运行定时任务',
    'cron.runConfirm': '立即运行「{name}」？',
    'cron.jobDeleted': '任务「{name}」已删除',
    'cron.jobTriggered': '任务「{name}」已触发',
    'cron.deleteFailed': '删除任务失败',
    'cron.runFailed': '运行任务失败',
    'cron.name': '名称',
    'cron.schedule': '调度',
    'cron.command': '命令',

    // Tasks
    'tasks.title': '任务',
    'tasks.queued': '排队中',
    'tasks.running': '运行中',
    'tasks.completed': '已完成',
    'tasks.failed': '已失败',
    'tasks.empty': '暂无任务',
    'tasks.emptyHint': '当智能体处理消息时，任务将显示在这里',

    // Dashboard
    'dashboard.title': '仪表盘',
    'dashboard.status': '状态',
    'dashboard.model': '模型',
    'dashboard.uptime': '运行时长',
    'dashboard.version': '版本',
    'dashboard.memoryItems': '记忆条目',
    'dashboard.evolutionRecords': '进化记录',
    'dashboard.activeTasks': '活跃任务',
    'dashboard.tools': '工具',
    'dashboard.skills': '技能',
    'dashboard.recentEvolution': '最近进化',
    'dashboard.noTools': '暂无已注册工具',
    'dashboard.noSkills': '暂无技能',

    // Evolution
    'nav.evolution': '自进化',
    'evolution.title': '自进化中心',
    'evolution.triggerNew': '新增技能',
    'evolution.totalRecords': '总记录',
    'evolution.evolving': '进化中',
    'evolution.completed': '已完成',
    'evolution.failed': '已失败',
    'evolution.skills': '技能数',
    'evolution.tools': '工具数',
    'evolution.skillEvolution': '技能进化',
    'evolution.capEvolution': '工具进化',
    'evolution.testAndEvolve': '测试 & 进化',
    'evolution.filter_all': '全部',
    'evolution.filter_active': '进行中',
    'evolution.filter_completed': '已完成',
    'evolution.filter_failed': '失败',
    'evolution.noSkillRecords': '暂无技能进化记录',
    'evolution.noCapRecords': '暂无工具进化记录',
    'evolution.triggerEvolution': '手动触发进化',
    'evolution.skillName': '技能名称',
    'evolution.selectSkill': '选择技能...',
    'evolution.description': '描述',
    'evolution.descPlaceholder': '描述需要改进的内容...',
    'evolution.trigger': '触发',
    'evolution.newSkillTitle': '新增技能',
    'evolution.newSkillDesc': '描述你想要创建的技能。系统会先搜索是否已有类似技能。',
    'evolution.newSkillPlaceholder': '描述技能功能，例如「监控BTC价格，跌破60000时告警」...',
    'evolution.searchingSkills': '正在搜索类似技能...',
    'evolution.similarSkillsFound': '发现类似技能',
    'evolution.noSimilarSkills': '未找到类似技能，可以创建新技能。',
    'evolution.similarSkillHint': '已存在类似技能，你可以先测试它，或继续创建新技能。',
    'evolution.proceedCreate': '仍然创建新技能',
    'evolution.useExisting': '使用此技能',
    'evolution.designingSkill': '正在设计新技能...',
    'evolution.skillCreated': '技能创建已触发',
    'evolution.newSkillName': '技能名称',
    'evolution.newSkillNamePlaceholder': '例如 btc_price_alert',
    'evolution.createSkill': '创建技能',
    'evolution.testAndEvolveTitle': '测试 & 进化技能',
    'evolution.testAndEvolveDesc': '测试技能效果，如果结果不满意可以触发进化改进。',
    'evolution.testResultSatisfied': '结果满意',
    'evolution.testResultUnsatisfied': '需要改进',
    'evolution.evolveFromTest': '触发进化',
    'evolution.evolveDesc': '根据测试结果，描述需要改进的地方：',
    'evolution.evolveDescPlaceholder': '例如「输出格式应包含更多细节」或「需要处理边界情况...」',
    'evolution.evolveTriggered': '已根据测试反馈触发进化',
    'evolution.matchScore': '匹配度',
    'evolution.matchedIn': '匹配字段',
    'evolution.attempt': '第 {n} 次尝试',
    'evolution.triggerInfo': '触发信息',
    'evolution.id': 'ID',
    'evolution.version': '版本',
    'evolution.created': '创建时间',
    'evolution.updated': '更新时间',
    'evolution.errorStack': '错误堆栈',
    'evolution.patch': '生成的补丁',
    'evolution.showCode': '显示代码',
    'evolution.hideCode': '隐藏代码',
    'evolution.audit': '审计',
    'evolution.auditPassed': '审计通过',
    'evolution.auditFailed': '审计失败',
    'evolution.shadowTest': '影子测试',
    'evolution.testPassed': '测试通过',
    'evolution.testFailed': '测试失败',
    'evolution.rollout': '灰度发布',
    'evolution.stage': '阶段',
    'evolution.feedbackHistory': '反馈历史',
    'evolution.deleteRecord': '删除记录',
    'evolution.deleteConfirm': '确定要删除此进化记录吗？',
    'evolution.detail': '详情',
    'evolution.provider': '提供者',
    'evolution.sourceCode': '源代码',
    'evolution.compileOutput': '编译输出',
    'evolution.validation': '验证',
    'evolution.validationPassed': '验证通过',
    'evolution.validationFailed': '验证失败',
    'evolution.testSkillTitle': '测试 & 进化技能',
    'evolution.testSkillDesc': '选择技能进行测试，如果结果不满意可以触发进化改进。',
    'evolution.testInput': '测试输入',
    'evolution.testInputPlaceholder': '输入测试条件或数据...',
    'evolution.runTest': '运行测试',
    'evolution.loadingSuggestion': '正在生成测试用例...',
    'evolution.executingTest': '正在执行技能测试...',
    'evolution.aiSuggested': 'AI 建议 · 可编辑',
    'evolution.overview': '总览',
    'evolution.architecture': '系统架构',
    'evolution.layerAgent': '智能体',
    'evolution.layerSkill': '技能层',
    'evolution.layerTool': '工具层',
    'evolution.layerCapability': '进化工具层',
    'evolution.registered': '已注册',
    'evolution.builtinTools': '个内置工具',
    'evolution.dynamicTools': '动态工具',
    'evolution.skillDesc': '编排策略进化 — 改进任务的组合和执行方式',
    'evolution.capDesc': '原子工具进化 — 生成新的系统/API/硬件交互工具',
    'evolution.skillPipeline': '流水线: 触发 → 生成 → 审计 → 测试 → 灰度 → 完成',
    'evolution.skillProduct': '产物: .md (提示词) + .rhai (脚本)',
    'evolution.capPipeline': '流水线: 请求 → 生成 → 编译 → 验证 → 激活',
    'evolution.capProduct': '产物: .sh / .py / .rs (可执行文件)',
    'evolution.recentActivity': '最近活动',
    'evolution.decisionBoundary': '进化决策边界',
    'evolution.decisionSkill': '任务执行策略需要改进（如优化分析流程、改进报告格式）',
    'evolution.decisionCap': '需要新的工具（如硬件访问、API集成、数据处理）',
    'evolution.decisionAuto': 'Skill 因缺少工具失败 → 自动先触发工具进化',
    'evolution.versionHistory': '版本历史',
    'evolution.showVersions': '显示版本',
    'evolution.hideVersions': '隐藏版本',
    'evolution.noVersions': '暂无版本快照',
    'evolution.schemas': '输入 / 输出 Schema',
    'evolution.artifactPath': '产物路径',

    // Memory
    'memory.title': '记忆',
    'memory.searchPlaceholder': '搜索记忆...',
    'memory.empty': '未找到记忆',
    'memory.addMemory': '添加记忆',
    'memory.deleteTitle': '删除记忆',
    'memory.deleteConfirm': '确定要删除此记忆吗？',

    // Alerts
    'alerts.title': '告警',
    'alerts.empty': '暂无告警规则',
    'alerts.createRule': '创建规则',
    'alerts.emptyHint': '创建规则以监控价格、指标等数据',
    'alerts.noHistory': '暂无告警触发记录',

    // Streams
    'streams.title': '数据流',
    'streams.empty': '暂无活跃数据流',

    // Ghost
    'ghost.title': '幽灵智能体',
    'ghost.settings': '设置',
    'ghost.activityLog': '活动日志',
    'ghost.description': '幽灵智能体是一个后台维护服务，按计划运行以整理记忆、清理文件并与社区中心交互。',
    'ghost.enableTitle': '启用幽灵智能体',
    'ghost.enableDesc': '按计划运行后台维护任务',
    'ghost.model': '模型',
    'ghost.modelHint': '选择已配置的模型或输入自定义模型名。幽灵智能体使用此模型执行后台例程。',
    'ghost.modelPlaceholder': '输入模型名称...',
    'ghost.schedule': '调度计划',
    'ghost.everyHour': '每小时',
    'ghost.every2Hours': '每 2 小时',
    'ghost.every4Hours': '每 4 小时（默认）',
    'ghost.every8Hours': '每 8 小时',
    'ghost.every12Hours': '每 12 小时',
    'ghost.dailyMidnight': '每天午夜',
    'ghost.dailyAt2AM': '每天凌晨 2 点',
    'ghost.dailyAt6AM': '每天早上 6 点',
    'ghost.custom': '自定义',
    'ghost.customHint': '输入 cron 表达式',
    'ghost.currentSchedule': '当前调度',
    'ghost.maxSyncsPerDay': '每日最大同步次数',
    'ghost.maxSyncsHint': '限制幽灵智能体每天的运行次数以控制成本。',
    'ghost.autoSocial': '自动社交互动',
    'ghost.enableHubSync': '启用社区中心同步',
    'ghost.autoSocialHint': '幽灵智能体将发送心跳并检查社区中心的热门技能。',
    'ghost.saveChanges': '保存更改',
    'ghost.saving': '保存中...',
    'ghost.loadFailed': '加载幽灵智能体配置失败。',
    'ghost.noActivityTitle': '暂无幽灵活动',
    'ghost.noActivityDesc': '在设置中启用幽灵智能体，它将开始运行后台维护任务。活动日志将显示在这里。',
    'ghost.activityRecords': '{n} 条活动记录',
    'ghost.messages': '{n} 条消息',
    'ghost.routinePrompt': '例程提示词',

    // Files
    'files.title': '文件',
    'files.folders': '文件夹',
    'files.fileCount': '文件',
    'files.workspace': '工作区',
    'files.chooseFile': '选择文件',
    'files.createTextFile': '或创建文本文件：',
    'files.filenamePlaceholder': '文件名.txt',
    'files.contentPlaceholder': '文件内容...',
    'files.emptyDir': '空目录',
    'files.media': '媒体',
    'files.binaryFile': '二进制文件（{mimeType}）',
    'files.downloadToView': '下载后查看',
  },
};

/**
 * Get a translated string. Supports {name} interpolation.
 */
export function t(key: string, params?: Record<string, string | number>): string {
  const locale = useI18nStore.getState().locale;
  let text = translations[locale]?.[key] || translations['en']?.[key] || key;
  if (params) {
    for (const [k, v] of Object.entries(params)) {
      text = text.replace(new RegExp(`\\{${k}\\}`, 'g'), String(v));
    }
  }
  return text;
}

/**
 * React hook that returns a translation function and re-renders on locale change.
 */
export function useT() {
  const locale = useI18nStore((s) => s.locale);
  return (key: string, params?: Record<string, string | number>): string => {
    let text = translations[locale]?.[key] || translations['en']?.[key] || key;
    if (params) {
      for (const [k, v] of Object.entries(params)) {
        text = text.replace(new RegExp(`\\{${k}\\}`, 'g'), String(v));
      }
    }
    return text;
  };
}
